<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="https://npmcdn.com/parse/dist/parse.min.js"></script>
    <title>WebStack</title>
</head>
<body>
    <img src="excluir.png" alt="" class="edit" hidden>  
    <header>
        <nav class="navbar">
        <a href="index.html" class="logo">Library</a>   
            <ul class="nav-menu">
                <li class="nav-item"> <a href="index.html" class="nav-link" id="marca">Catálogo de Livros</a></li>
                <li class="nav-item"> <a href="#" class="nav-link">Aluguel de Livros</a></li>
                <li class="nav-item"> <a href="#" class="nav-link">Cadastro de Funcionário</a></li>
                <li class="nav-item"> <a href="#" class="nav-link">Estoque de Livros</a></li>
            </ul>
            <div class="hamburguer">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </nav>
    
    </header>

    <button id="add">Adicionar Livro</button>

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <form>
        <label for="titulo">Nome do Livro: </label> 
        <input type="text" id="livro"> <br> <br>
        <label for="titulo">Autor do Livro: </label>
        <input type="text" id="autor"> <br> <br>
        <label for="titulo">Ano de lançamento do Livro: </label>
        <input type="number" id="ano_lanc"> <br> <br>
        <input id="salvar" value="Salvar" onclick="saveBook()"/>
    </form>
  </div>

</div>

    <table id="library">
        <tr>
            <th>
                Livro
            </th>
            <th>
                Autor
            </th>
            <th>
                Ano Lançamento
            </th>
            <th>
                Ações
            </th>
        </tr>
        <tr id="teste">
        </tr>
    </table>
</body>

<footer>
    <p><a href="https://www.flaticon.com/br/icones-gratis/desinstalar" title="desinstalar ícones" id="link">Ícones criados por feen - Flaticon</a></p>
</footer>
<script src="scripts.js"></script>
<script
type="module"
src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
></script>

<script>
    // Initialize Parse
      Parse.initialize("GuU1rOfMH8uOj08uIoK3CvjUphB7MWhbRzu0R8U8", "J5HBPvBlD0V0Eh5yhHET2PSQAaV0q97gpcGIvT5x"); //PASTE HERE YOUR Back4App APPLICATION ID AND YOUR JavaScript KEY
      Parse.serverURL = "https://parseapi.back4app.com/";

      (async () => {
const query = new Parse.Query('catalogo');
// You can also query by using a parameter of an object
// query.equalTo('objectId', 'xKue915KBG');
const results = await query.find();
try {
for (const object of results) {
  // Access the Parse Object attributes using the .GET method
  const id = object.get('createdAt');
  const teste = object.id;
  const livro = object.get('livro');
  const autor = object.get('autor');
  const ano_lanc = object.get('ano_lancamento');
  const element = document.getElementById('library');
  console.log(id, teste);
  let qtlinha = element.rows.length;
  var linha = element.insertRow(qtlinha);
  var insert_livro = linha.insertCell(0);
  var insert_autor = linha.insertCell(1);
  var insert_ano_lanc = linha.insertCell(2);
  var editar = linha.insertCell(3);
  insert_livro.innerHTML = `${livro}`;
  insert_autor.innerHTML = `${autor}`;
  insert_ano_lanc.innerHTML = `${ano_lanc}`;
  editar.innerHTML = "<button id='edit'><img src='editar.png'></button>" + "<button id='delete'><img src='excluir.png'></button>";
}
} catch (error) {
console.error('Error durante a busca de dados: ', error);
}
})();
;

async function saveBook(){
(async () => {
  const myNewObject = new Parse.Object('catalogo');
  var livro = document.getElementById('livro').value;
  var autor = document.getElementById('autor').value;
  var ano_lanc = parseInt(document.getElementById('ano_lanc').value);
  myNewObject.set('livro', livro);
  myNewObject.set('autor', autor);
  myNewObject.set('ano_lancamento', ano_lanc);
  console.log(livro, autor, ano_lanc, myNewObject);
  try {
    const result = await myNewObject.save();
    // Access the Parse Object attributes using the .GET method
    console.log('object livro: ', result.get('livro'));
    console.log('object autor: ', result.get('autor'));
    console.log('object ano_lancamento: ', result.get('ano_lancamento'));
    alert('Livro adicionado com sucesso');
    window.location.reload();
  } catch (error) {
    alert('Error ao adicionar o livro: ' + error);
  }
})();};
    
    </script>


</html>